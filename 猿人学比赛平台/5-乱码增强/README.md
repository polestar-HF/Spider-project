## çŒ¿äººå­¦ç¬¬äº”é¢˜ï¼ˆä¹±ç å¢å¼ºï¼‰
> https://match.yuanrenxue.com/match/5  
> æŠ“å–å…¨éƒ¨5é¡µç›´æ’­é—´çƒ­åº¦ï¼Œè®¡ç®—å‰5åç›´æ’­é—´çƒ­åº¦çš„åŠ å’Œ  
>  > ç¬¬äº”é¢˜çš„æ ‡é¢˜ â€œä¹±ç å¢å¼ºâ€ å°±çŒœæµ‹å‡ºæœ‰ä»£ç æ··æ·†  
> é¡µé¢æ¸©é¦¨æç¤ºï¼šcookieæœ‰æ•ˆæœŸ50ç§’, çœ‹æ¥æœ¬é¢˜çš„éš¾ç‚¹ä¸»è¦å°±åœ¨cookie
---
### 1.åˆ†æ
- é€šè¿‡æŠ“åŒ…å‘ç°æœ‰4ä¸ªå‚æ•°æ¯æ¬¡è¯·æ±‚éƒ½åœ¨å˜åŒ–
  - m (cookieå‚æ•°)
    - `m=ff74828b4cd39e2ab8bb0912bbfb375c`(32ä½) --> çŒœæµ‹æ˜¯MD5(ä¸æ˜¯å¸¸è§çš„MD5åŠ å¯†, è¢«ä¿®æ”¹è¿‡)åŠ å¯†çš„æ—¶é—´æˆ³
  - RM4hZBv0dDon443M (cookieå‚æ•°)
    - æœªçŸ¥
  - m (urlå‚æ•°)
    - `m: 1634354893158` åº”è¯¥æ˜¯æ—¶é—´æˆ³
  - f (urlå‚æ•°)
    - `f: 1634354892000` åº”è¯¥ä¹Ÿæ˜¯æ—¶é—´æˆ³ï¼ˆä½†ä¸mçš„ç”Ÿæˆæ–¹å¼ä¸åŒï¼‰
---
### 2.jsä»£ç è¿˜åŸ
> ä»£ç è¿˜åŸéœ€è¦å…ˆæ‰¾åˆ°ä»£ç è¿è¡Œçš„å…¥å£, å†é€å±‚è¿˜åŸ  
> å¯ä»¥å…ˆå…¨å±€æœç´¢å„ä¸ªå‚æ•°å, ä½†æ˜¯ç”±äº mã€f è¿‡äºå¸¸è§, åŒ¹é…çš„æœç´¢ç»“æœå¤ªå¤š(æ— ä»ä¸‹æ‰‹ã€‚ã€‚ã€‚)  
> æœç´¢ `RM4hZBv0dDon443M` å‘ç°æ²¡æœ‰åŒ¹é…çš„ç»“æœ, çŒœæµ‹æœ‰å¯èƒ½æ˜¯æ‹¼æ¥å­—ç¬¦ä¸², æ‰€ä»¥æœä¸åˆ°
- ä»£ç å…¥å£
![img.png](img.png)
- ç‚¹å‡»è¿›å»å¾€ä¸Šç¿»ç¿»å°±å¯ä»¥çœ‹åˆ°ä»£ç è¿è¡Œçš„å…¥å£, æ‰¾åˆ°å…¥å£æ¥ä¸‹æ¥å°±æ˜¯æ‰“æ–­ç‚¹å’Œæ„‰å¿«çš„æ‰£ä»£ç ğŸ˜­
![img_1.png](img_1.png)
- #### è¸©å‘
  - `_0x4e96b4` å‚æ•°åœ¨æ§åˆ¶å°æ‰“å°è¾“å‡ºå‘ç°æ˜¯windowå¯¹è±¡, æˆ‘ä»¥ä¸ºæ˜¯ä¸ªæ£€æµ‹ç‚¹(é‡‡ç”¨jsdomæ¨¡æ‹Ÿè¿˜åŸjså¯¹è±¡), ç»è¿‡æµ‹è¯•ç›´æ¥èµ‹å€¼{}å°±å¯ä»¥
  - `_0x4e96b4['_$pr']`æ•°ç»„é‡Œé¢æ”¾çš„å€¼æ—¶éœ€è¦AESåŠ å¯†çš„å­—ç¬¦ä¸², è°ƒè¯•å‘ç°è¿™äº›å€¼ä¸cookieä¸­mæ˜¯åŒä¸€ä¸ªåŠ å¯†å‡½æ•°ç”Ÿæˆçš„, ä¼ å…¥çš„æ—¶é—´æˆ³, æ—¶é—´æˆ³ä¸èƒ½å†™å®šå€¼, å¿…é¡»æ˜¯å½“å‰æ—¶é—´æˆ³
  ![img_2.png](img_2.png)
  - AESåŠ å¯†çš„ key æ˜¯é€šè¿‡btoa(æ—¶é—´æˆ³)å–å‰16ä½, è°ƒè¯•å‘ç°btoaæ–¹æ³•ä¼ å…¥çš„æ—¶é—´æˆ³ == m (urlå‚æ•°)
  - `_$UH`æ˜¯ä¸€ä¸ªé•¿æ•°ç»„ï¼ˆlength: 725ï¼‰,å¯ä»¥ä½¿ç”¨`copy(array_name)`å¿«é€Ÿå¤åˆ¶
  - pythonè¯·æ±‚æ—¶éœ€è¦å°†user-agentè®¾ç½®æˆ`'yuanrenxue.project'`
---
### 3.ç»“è®º
- ä»£ç ç»è¿‡æ··æ·†åŠ å¯†
- urlå‚æ•° `m` çš„å€¼æ˜¯æ—¶é—´æˆ³ == `m (cookieå‚æ•°)`MD5åŠ å¯†çš„æ—¶é—´æˆ³
- urlå‚æ•° `f` çš„å€¼æ˜¯æ—¶é—´æˆ³åŒæ—¶ä¹Ÿæ˜¯cookieè¿‡æœŸæ—¶é—´ --> å½“å‰æ—¶é—´æˆ³ - f > 50s --> cookieè¿‡æœŸ